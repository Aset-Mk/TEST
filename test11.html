<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>–¢–µ—Å—Ç ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ JSON</title>
  <style>
    /* ===== –ë–ê–ó–û–í–´–ï –°–¢–ò–õ–ò ===== */
    :root{
      --bg: #f4f7fb;
      --card: #ffffff;
      --muted: #6b7280;
      --accent: #0f62fe;
      --accent-strong: #083a9e;
      --success: #16a34a;
      --danger: #dc2626;
      --shadow: 0 6px 20px rgba(15,20,40,0.08);
      --radius: 12px;
      --gap: 16px;
      font-family: Inter, ui-sans-serif, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    html,body{
      height:100%;
      margin:0;
      background: linear-gradient(180deg, rgba(15,98,254,0.03), transparent 40%), var(--bg);
      color:#0b1220;
    }

    .app {
      max-width: 900px;
      margin: 28px auto;
      padding: 20px;
      box-sizing: border-box;
    }

    header {
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      margin-bottom:14px;
    }

    header h1{
      font-size:20px;
      margin:0;
    }

    .controls {
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }

    button {
      background: var(--accent);
      color: white;
      border: none;
      padding:10px 14px;
      border-radius:10px;
      cursor:pointer;
      box-shadow: var(--shadow);
      font-weight:600;
      transition: transform .08s ease, box-shadow .12s;
    }
    button:hover{ transform: translateY(-2px); }
    button.secondary{
      background: white;
      color: var(--accent);
      border: 1px solid rgba(15,98,254,0.12);
      box-shadow:none;
    }
    button.ghost{
      background: transparent;
      color: var(--muted);
      border: 1px dashed rgba(15,98,254,0.08);
      font-weight:500;
    }

    .card {
      background: var(--card);
      border-radius: var(--radius);
      padding: 18px;
      box-shadow: var(--shadow);
    }

    .question-container {
      display:flex;
      gap:18px;
      align-items:flex-start;
      flex-direction:column;
    }

    .meta {
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:12px;
      margin-bottom:8px;
    }

    .progress {
      color:var(--muted);
      font-size:14px;
    }

    .question-text {
      font-size:18px;
      font-weight:600;
      margin:0 0 8px 0;
    }

    .options {
      display:grid;
      grid-template-columns: 1fr;
      gap:10px;
    }

    /* –≤–∞—Ä–∏–∞–Ω—Ç-–æ—Ç–≤–µ—Ç –∫–∞–∫ –∫–∞—Ä—Ç–æ—á–∫–∞ */
    .option {
      display:flex;
      align-items:center;
      gap:12px;
      padding:12px;
      border-radius:10px;
      border:2px solid transparent;
      background: linear-gradient(180deg, rgba(240,246,255,0.6), rgba(255,255,255,0.6));
      cursor:pointer;
      transition: transform .08s ease, background .12s ease, border-color .12s;
    }

    .option:hover{
      transform: translateY(-3px);
      background: rgba(240,249,255,1);
    }

    .option input[type="radio"]{
      appearance:none;
      width:18px;
      height:18px;
      border-radius:50%;
      border:2px solid #cbd5e1;
      display:inline-block;
      position:relative;
      flex:0 0 18px;
    }
    .option input[type="radio"]:checked{
      background: var(--accent);
      border-color: var(--accent-strong);
      box-shadow: 0 0 0 4px rgba(15,98,254,0.08);
    }

    .option .text{
      font-size:15px;
    }

    .option.selected{
      border-color: var(--accent-strong);
      box-shadow: 0 8px 24px rgba(9,30,80,0.06);
      background: linear-gradient(180deg, rgba(14,84,217,0.06), rgba(255,255,255,0.6));
    }

    .nav {
      display:flex;
      gap:8px;
      margin-top: 14px;
      justify-content:space-between;
      align-items:center;
    }

    .left-controls {
      display:flex;
      gap:8px;
      align-items:center;
      flex-wrap:wrap;
    }

    .right-controls { display:flex; gap:8px; align-items:center; }

    /* –°—Ç–∏–ª—å –¥–ª—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
    .results {
      margin-top:16px;
      display:grid;
      gap:12px;
    }

    .result-item{
      display:flex;
      flex-direction:column;
      gap:6px;
      padding:10px;
      border-radius:10px;
      background: linear-gradient(180deg, #ffffff, #fbfdff);
      border: 1px solid rgba(15,98,254,0.04);
    }

    .result-question {
      font-weight:600;
    }

    .result-correct { color: var(--success); font-weight:700; }
    .result-wrong { color: var(--danger); font-weight:700; }

    /* –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ */
    .modal-backdrop{
      position:fixed;
      inset:0;
      background: rgba(4,10,25,0.5);
      display:none;
      align-items:center;
      justify-content:center;
      z-index:999;
      padding:16px;
    }
    .modal-backdrop.active{ display:flex; }
    .modal {
      max-width:900px;
      width:100%;
      max-height:90vh;
      overflow:auto;
      padding:18px;
      border-radius:12px;
    }

    /* –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å */
    @media (min-width:720px){
      .options{ grid-template-columns: 1fr 1fr; }
      header h1{ font-size:22px; }
    }

    @media (max-width:480px){
      .app{ padding:12px; margin:10px; }
      .option{ padding:10px; }
      button{ padding:8px 10px; font-size:14px; border-radius:8px; }
    }

    /* –º–µ–ª–∫–∏–µ –ø–æ–¥—Å–∫–∞–∑–∫–∏ */
    .hint { color: var(--muted); font-size:13px; }
    .small { font-size:13px; color:var(--muted); }

  </style>
</head>
<body>
  <div class="app">
    <header>
      <div class="controls">
        <button id="shuffleQuestionsBtn" title="–ü–µ—Ä–µ–º–µ—à–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤">üîÄ –ü–µ—Ä–µ–º–µ—à–∞—Ç—å</button>
        <button id="restartBtn" class="secondary" title="–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç —Å–Ω–∞—á–∞–ª–∞ (—Å —Ç–µ–∫—É—â–∏–º–∏ –≤–æ–ø—Ä–æ—Å–∞–º–∏)">–ù–∞—á–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞</button>
      </div>
    </header>

    <main class="card">
      <div class="question-container">
        <div class="meta">
          <div class="progress" id="progressLabel">–í–æ–ø—Ä–æ—Å 0 –∏–∑ 0</div>
          <div class="small" id="loadedFrom">–§–∞–π–ª –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω</div>
        </div>

        <div>
          <p class="question-text" id="questionText">–ó–∞–≥—Ä—É–∑–∏—Ç–µ JSON —Ñ–∞–π–ª —Å –≤–æ–ø—Ä–æ—Å–∞–º–∏, –Ω–∞–∂–∞–≤ –∫–Ω–æ–ø–∫—É "üìÅ –ó–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª"</p>
        </div>

        <div class="options" id="optionsList">
          <!-- –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤ –±—É–¥—É—Ç —Ä–µ–Ω–¥–µ—Ä–∏—Ç—å—Å—è —Å—é–¥–∞ -->
        </div>

        <div class="nav">
          <div class="left-controls">
            <button id="prevBtn" class="secondary">‚Üê –ù–∞–∑–∞–¥</button>
            <button id="nextBtn" class="secondary">–í–ø–µ—Ä–µ–¥ ‚Üí</button>
            <div class="hint" id="answerInfo">–û—Ç–≤–µ—Ç –Ω–µ –≤—ã–±—Ä–∞–Ω</div>
          </div>

          <div class="right-controls">
            <button id="finishBtn">–ó–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ—Å—Ç</button>
          </div>
        </div>
      </div>
    </main>

    <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Å —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞–º–∏ -->
    <div id="resultsModal" class="modal-backdrop" role="dialog" aria-modal="true">
      <div class="card modal" id="resultsContent">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <h2 style="margin:0">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∞</h2>
          <div style="display:flex;gap:8px;align-items:center;">
            <button id="closeResults" class="secondary">–ó–∞–∫—Ä—ã—Ç—å</button>
            <button id="restartAll" title="–ù–∞—á–∞—Ç—å –∑–∞–Ω–æ–≤–æ" >–ù–∞—á–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞</button>
          </div>
        </div>

        <div id="scoreSummary" style="margin-top:12px;"></div>

        <div id="detailedResults" class="results" style="margin-top:12px;"></div>
      </div>
    </div>

  </div>

  <script>
    /* =================== –õ–æ–≥–∏–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è =================== */
    
    // ====== –ù–ê–°–¢–†–û–ô–ö–ê: –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å –∫ –≤–∞—à–µ–º—É JSON —Ñ–∞–π–ª—É ======
    const JSON_FILE_URL = '/questions.json'; // –ò–∑–º–µ–Ω–∏—Ç–µ –Ω–∞ –ø—É—Ç—å –∫ –≤–∞—à–µ–º—É —Ñ–∞–π–ª—É
    // ==========================================================

    // ================== State (—Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è) ==================
    let originalQuestions = []; // –∫–æ–ø–∏—è –≤–æ–ø—Ä–æ—Å–æ–≤
    let questions = [];         // —Ç–µ–∫—É—â–∏–π –º–∞—Å—Å–∏–≤ –≤–æ–ø—Ä–æ—Å–æ–≤
    let optionsMap = {};        // –∫–ª—é—á: –∏–Ω–¥–µ–∫—Å –≤–æ–ø—Ä–æ—Å–∞ -> –º–∞—Å—Å–∏–≤ –æ–±—ä–µ–∫—Ç–æ–≤ –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ {id, text} (–ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã–π)
    let selections = {};        // –∫–ª—é—á: –∏–Ω–¥–µ–∫—Å –≤–æ–ø—Ä–æ—Å–∞ -> ID –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ (–Ω–∞–ø—Ä–∏–º–µ—Ä "a")
    let currentIndex = 0;       // –∏–Ω–¥–µ–∫—Å —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
    let loadedFrom = 'none'; 

    // ======== DOM elements ========
    const progressLabel = document.getElementById('progressLabel');
    const questionText = document.getElementById('questionText');
    const optionsList = document.getElementById('optionsList');
    const prevBtn = document.getElementById('prevBtn');
    const nextBtn = document.getElementById('nextBtn');
    const finishBtn = document.getElementById('finishBtn');
    const shuffleQuestionsBtn = document.getElementById('shuffleQuestionsBtn');
    const restartBtn = document.getElementById('restartBtn');
    const resultsModal = document.getElementById('resultsModal');
    const detailedResults = document.getElementById('detailedResults');
    const scoreSummary = document.getElementById('scoreSummary');
    const closeResults = document.getElementById('closeResults');
    const restartAll = document.getElementById('restartAll');
    const answerInfo = document.getElementById('answerInfo');
    const loadedFromLabel = document.getElementById('loadedFrom');

    // ======== –£—Ç–∏–ª–∏—Ç—ã ========
    function shuffleArray(arr) {
      const a = arr.slice();
      for (let i = a.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    // –ì–ª—É–±–æ–∫–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ (–±–µ–∑ –ø–æ–ª—è id, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –Ω—É–∂–Ω–æ)
    function deepCloneQuestions(qs){
      return qs.map(q => ({
        question_text: q.question_text, 
        answers: q.answers.map(a => ({...a})), 
        correct_answer: q.correct_answer 
      }));
    }

    // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
    function initWithQuestions(qs, fromLabel='file') {
      originalQuestions = deepCloneQuestions(qs);
      questions = deepCloneQuestions(qs);
      loadedFrom = fromLabel;
      loadedFromLabel.textContent = fromLabel === 'file' ? '–ó–∞–≥—Ä—É–∂–µ–Ω–æ –∏–∑ —Ñ–∞–π–ª–∞' : '–í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç';
      resetState(false);
      
      // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø–µ—Ä–µ–º–µ—à–∞–Ω–Ω—ã–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –æ—Ç–≤–µ—Ç–æ–≤
      questions.forEach((q, idx) => {
        optionsMap[idx] = shuffleArray(q.answers);
      });
      renderCurrent();
    }

    function resetState(keepOriginalOrder=false) {
      selections = {};
      currentIndex = 0;
      if (!keepOriginalOrder) {
        questions = deepCloneQuestions(originalQuestions);
        optionsMap = {};
        questions.forEach((q, idx) => optionsMap[idx] = shuffleArray(q.answers));
      } else {
        optionsMap = {};
        questions.forEach((q, idx) => optionsMap[idx] = shuffleArray(q.answers));
      }
      updateProgress();
    }

    function shuffleQuestions() {
      questions = shuffleArray(questions);
      optionsMap = {};
      questions.forEach((q, idx) => optionsMap[idx] = shuffleArray(q.answers));
      selections = {};
      currentIndex = 0;
      updateProgress();
      renderCurrent();
    }

    // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è: –Ω–∞–π—Ç–∏ —Ç–µ–∫—Å—Ç –æ—Ç–≤–µ—Ç–∞ –ø–æ –µ–≥–æ ID –≤–Ω—É—Ç—Ä–∏ –≤–æ–ø—Ä–æ—Å–∞
    function getAnswerText(questionObj, answerId) {
      if (!answerId) return null;
      const found = questionObj.answers.find(a => a.id === answerId);
      return found ? found.text : answerId;
    }

    // –†–µ–Ω–¥–µ—Ä —Ç–µ–∫—É—â–µ–≥–æ –≤–æ–ø—Ä–æ—Å–∞
    function renderCurrent() {
      if (!questions.length) {
        questionText.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞ –≤–æ–ø—Ä–æ—Å–æ–≤...';
        optionsList.innerHTML = '';
        progressLabel.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
        prevBtn.disabled = true;
        nextBtn.disabled = true;
        finishBtn.disabled = true;
        shuffleQuestionsBtn.disabled = true;
        restartBtn.disabled = true;
        answerInfo.textContent = '';
        return;
      }

      // –í–∫–ª—é—á–∞–µ–º –∫–Ω–æ–ø–∫–∏
      shuffleQuestionsBtn.disabled = false;
      restartBtn.disabled = false;
      finishBtn.disabled = false;

      updateProgress();
      const q = questions[currentIndex];
      questionText.textContent = q.question_text;

      const opts = optionsMap[currentIndex] || shuffleArray(q.answers);
      optionsList.innerHTML = '';
      
      opts.forEach((optObj, optIdx) => {
        const uniqueId = `opt-${currentIndex}-${optIdx}`;

        const wrapper = document.createElement('label');
        wrapper.className = 'option';
        
        const radio = document.createElement('input');
        radio.type = 'radio';
        radio.name = 'option';
        radio.id = uniqueId;
        radio.value = optObj.id;

        // –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É–∂–µ –≤—ã–±—Ä–∞–ª —ç—Ç–æ—Ç ID
        if (selections[currentIndex] && selections[currentIndex] === optObj.id) {
          radio.checked = true;
          wrapper.classList.add('selected');
        }

        radio.addEventListener('change', () => {
          selections[currentIndex] = optObj.id;
          document.querySelectorAll('.option').forEach(el => el.classList.remove('selected'));
          wrapper.classList.add('selected');
          updateAnswerInfo();
        });

        const txt = document.createElement('div');
        txt.className = 'text';
        txt.innerText = optObj.text;

        wrapper.appendChild(radio);
        wrapper.appendChild(txt);

        wrapper.addEventListener('click', (e) => {
          if (e.target.tagName.toLowerCase() === 'input') return;
          radio.checked = true;
          radio.dispatchEvent(new Event('change', { bubbles: true }));
        });

        optionsList.appendChild(wrapper);
      });

      prevBtn.disabled = currentIndex === 0;
      nextBtn.disabled = currentIndex === (questions.length - 1);

      updateAnswerInfo();
    }

    function updateProgress() {
      progressLabel.textContent = `–í–æ–ø—Ä–æ—Å ${currentIndex + 1} –∏–∑ ${questions.length}`;
    }

    function updateAnswerInfo(){
      if (!questions.length) return;
      const selId = selections[currentIndex];
      const q = questions[currentIndex];
      if (selId) {
        const txt = getAnswerText(q, selId);
        answerInfo.textContent = `–í—ã –≤—ã–±—Ä–∞–ª–∏: "${txt}"`;
      } else {
        answerInfo.textContent = '–û—Ç–≤–µ—Ç –Ω–µ –≤—ã–±—Ä–∞–Ω';
      }
    }

    // –ü–æ–¥—Å—á—ë—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
    function finishAndShowResults() {
      let correct = 0;
      let total = questions.length;
      const resultsData = [];

      questions.forEach((q, idx) => {
        const userAnsId = selections[idx] || null;
        const isCorrect = userAnsId !== null && userAnsId.toLowerCase() === q.correct_answer.toLowerCase();
        
        if (isCorrect) correct++;
        
        resultsData.push({
          index: idx,
          question: q.question_text,
          correctAnswerId: q.correct_answer,
          userAnswerId: userAnsId,
          isCorrect,
          correctAnswerText: getAnswerText(q, q.correct_answer),
          userAnswerText: getAnswerText(q, userAnsId)
        });
      });

      const percent = total ? Math.round((correct / total) * 100) : 0;

      scoreSummary.innerHTML = `
        <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;">
          <div style="font-size:20px;font-weight:700;">${correct} / ${total}</div>
          <div class="small">–ü—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤</div>
          <div style="margin-left:12px;font-weight:700;color:${percent >= 60 ? 'var(--success)' : 'var(--danger)'}">${percent}%</div>
          <div class="small">–ü—Ä–æ—Ü–µ–Ω—Ç</div>
        </div>
      `;

      detailedResults.innerHTML = '';
      resultsData.forEach(r => {
        const item = document.createElement('div');
        item.className = 'result-item';

        const qtitle = document.createElement('div');
        qtitle.className = 'result-question';
        qtitle.innerText = `–í–æ–ø—Ä–æ—Å ${r.index + 1}: ${r.question}`;
        item.appendChild(qtitle);

        const userLine = document.createElement('div');
        if (r.userAnswerId === null) {
          userLine.innerHTML = `<span class="result-wrong">–û—Ç–≤–µ—Ç –Ω–µ –¥–∞–Ω</span>`;
        } else if (r.isCorrect){
          userLine.innerHTML = `<span class="result-correct">–í–∞—à –æ—Ç–≤–µ—Ç: ${r.userAnswerText} ‚Äî –≤–µ—Ä–Ω–æ</span>`;
        } else {
          userLine.innerHTML = `<span class="result-wrong">–í–∞—à –æ—Ç–≤–µ—Ç: ${r.userAnswerText} ‚Äî –Ω–µ–≤–µ—Ä–Ω–æ</span>`;
        }
        item.appendChild(userLine);

        const correctLine = document.createElement('div');
        correctLine.innerHTML = `–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –æ—Ç–≤–µ—Ç: <strong>${r.correctAnswerText}</strong>`;
        item.appendChild(correctLine);

        detailedResults.appendChild(item);
      });

      resultsModal.classList.add('active');
    }

    // ======== –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π ========
    prevBtn.addEventListener('click', () => {
      if (currentIndex > 0) { currentIndex--; renderCurrent(); }
    });

    nextBtn.addEventListener('click', () => {
      if (currentIndex < questions.length - 1) { currentIndex++; renderCurrent(); }
    });

    finishBtn.addEventListener('click', () => {
      if (!questions.length) return;
      finishAndShowResults();
    });

    closeResults.addEventListener('click', () => {
      resultsModal.classList.remove('active');
    });

    shuffleQuestionsBtn.addEventListener('click', () => {
      if (!questions.length) return;
      if (!confirm('–ü–µ—Ä–µ–º–µ—à–∞—Ç—å –ø–æ—Ä—è–¥–æ–∫ –≤–æ–ø—Ä–æ—Å–æ–≤? –¢–µ–∫—É—â–∏–µ –æ—Ç–≤–µ—Ç—ã –±—É–¥—É—Ç —Å–±—Ä–æ—à–µ–Ω—ã.')) return;
      shuffleQuestions();
    });

    restartBtn.addEventListener('click', () => {
      if (!questions.length) return;
      if (!confirm('–ù–∞—á–∞—Ç—å —Ç–µ—Å—Ç —Å–Ω–∞—á–∞–ª–∞? –¢–µ–∫—É—â–∏–µ –æ—Ç–≤–µ—Ç—ã –±—É–¥—É—Ç —Å–±—Ä–æ—à–µ–Ω—ã.')) return;
      resetState(true);
      renderCurrent();
    });

    restartAll.addEventListener('click', () => {
      if (!confirm('–ü–æ–ª–Ω–æ—Å—Ç—å—é –Ω–∞—á–∞—Ç—å —Å–Ω–∞—á–∞–ª–∞ (–≤–µ—Ä–Ω—É—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –ø–æ—Ä—è–¥–æ–∫)?')) return;
      initWithQuestions(originalQuestions, loadedFrom);
      resultsModal.classList.remove('active');
    });

    // –ó–∞–≥—Ä—É–∑–∫–∞ JSON —Ñ–∞–π–ª–∞ –ø–æ URL
    async function loadQuestionsFromURL(url) {
      try {
        loadedFromLabel.textContent = '–ó–∞–≥—Ä—É–∑–∫–∞...';
        const response = await fetch(url);
        
        if (!response.ok) {
          throw new Error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Ñ–∞–π–ª: ${response.status} ${response.statusText}`);
        }
        
        const parsed = await response.json();
        
        if (!Array.isArray(parsed)) {
          throw new Error('JSON –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∞—Å—Å–∏–≤–æ–º');
        }
        
        if (parsed.length === 0) {
          throw new Error('JSON –º–∞—Å—Å–∏–≤ –ø—É—Å—Ç–æ–π');
        }
        
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –ø–µ—Ä–≤–æ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–∞
        const first = parsed[0];
        if (!first.question_text || !Array.isArray(first.answers) || !first.correct_answer) {
          throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ù—É–∂–Ω—ã –ø–æ–ª—è: question_text, answers (–º–∞—Å—Å–∏–≤), correct_answer');
        }

        // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É answers
        if (first.answers.length === 0 || !first.answers[0].id || !first.answers[0].text) {
          throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç answers. –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø–æ–ª—è: id, text');
        }

        initWithQuestions(parsed, 'file');
        console.log(`–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω! –í–æ–ø—Ä–æ—Å–æ–≤: ${parsed.length}`);
        
      } catch (err) {
        questionText.textContent = `–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${err.message}`;
        loadedFromLabel.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
        console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ JSON:', err);
      }
    }

    // –í–∞–ª–∏–¥–∞—Ü–∏—è –∑–∞–≥—Ä—É–∂–∞–µ–º–æ–≥–æ JSON —Ñ–∞–π–ª–∞ (–æ—Å—Ç–∞–≤–ª—è–µ–º –Ω–∞ —Å–ª—É—á–∞–π –µ—Å–ª–∏ –ø–æ–Ω–∞–¥–æ–±–∏—Ç—Å—è)
    /*
    fileInput.addEventListener('change', (e) => {
      const file = e.target.files[0];
      if (!file) return;
      const reader = new FileReader();
      reader.onload = (ev) => {
        try {
          const parsed = JSON.parse(ev.target.result);
          if (!Array.isArray(parsed)) throw new Error('JSON –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –º–∞—Å—Å–∏–≤–æ–º');
          
          if (parsed.length === 0) throw new Error('JSON –º–∞—Å—Å–∏–≤ –ø—É—Å—Ç–æ–π');
          
          const first = parsed[0];
          if (!first.question_text || !Array.isArray(first.answers) || !first.correct_answer) {
             throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç. –ù—É–∂–Ω—ã –ø–æ–ª—è: question_text, answers (–º–∞—Å—Å–∏–≤), correct_answer');
          }

          if (first.answers.length === 0 || !first.answers[0].id || !first.answers[0].text) {
            throw new Error('–ù–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç answers. –ö–∞–∂–¥—ã–π —ç–ª–µ–º–µ–Ω—Ç –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å –ø–æ–ª—è: id, text');
          }

          initWithQuestions(parsed, 'file');
          alert(`–¢–µ—Å—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω! –í–æ–ø—Ä–æ—Å–æ–≤: ${parsed.length}`);
        } catch (err) {
          alert('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ' + err.message);
        }
      };
      reader.readAsText(file);
      e.target.value = '';
    });
    */

    resultsModal.addEventListener('click', (e) => {
      if (e.target === resultsModal) resultsModal.classList.remove('active');
    });

    document.addEventListener('keydown', (e) => {
      if (!questions.length) return;
      if (e.key === 'ArrowLeft') prevBtn.click();
      if (e.key === 'ArrowRight') nextBtn.click();
      if (e.key === 'Enter' && (e.ctrlKey || e.metaKey)) finishBtn.click();
    });

    // –ó–∞–ø—É—Å–∫ - –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –∏–∑ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
    loadQuestionsFromURL(JSON_FILE_URL);
  </script>
</body>
</html>